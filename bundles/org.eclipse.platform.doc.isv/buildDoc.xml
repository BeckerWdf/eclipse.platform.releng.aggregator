<?xml version="1.0" encoding="UTF-8"?>
<project name="Platform Doc Isv Build" default="all"  basedir="." >

	<target name="init">
		<available file="${basedir}/index" property="index.present"/>
		
		<!-- find the binary 3.x doc plugin -->
		<pathconvert property="org.eclipse.platform.doc.isv_3.x" >
			<last><sort><fileset dir="${localRepoLocation}/plugins" includes="org.eclipse.platform.doc.isv_3.*.jar" /></sort></last>
		</pathconvert>
	</target>

	<target name="all" depends="init" unless="index.present">
		<antcall target="copyFrom3.xBinary" />
		<antcall target="build.index" />
	</target>


	<target name="copyFrom3.xBinary" >
		<echo message="Extracting content from ${org.eclipse.platform.doc.isv_3.x}" />
		<unzip src="${org.eclipse.platform.doc.isv_3.x}" dest="${basedir}" overwrite="false" >
			<patternset>
				<include name="reference/api/**" />
				<include name="reference/extension-points/**" />
				<include name="samples/**" />
			</patternset>
		</unzip>
	</target>
	
	<target name="build.index" description="Builds search index for the plug-in: org.eclipse.platform.doc.isv" if="eclipse.running">
		<help.buildHelpIndex manifest="${basedir}/plugin.xml" destination="${basedir}"/>
	</target>

</project>

